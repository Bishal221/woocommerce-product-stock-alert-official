"use strict";jQuery(function(e){let s=e(document).find(".stock_notifier-subscribe-form");function a(){var a;let t=s.find(".stock_manager_email").val(),i=s.find(".current_product_id").val(),r=s.find(".current_variation_id").val(),o=s.find(".current_product_name").val(),c=localizeData.button_html,n=localizeData.alert_success,l=localizeData.error_occurs,d=localizeData.try_again,u=localizeData.alert_email_exist,m=localizeData.valid_email,b=localizeData.ban_email_domain_text,p=localizeData.ban_email_address_text,f=localizeData.double_opt_in_success,v=localizeData.unsubscribe_button;if(n=(n=n.replace("%product_title%",t)).replace("%customer_email%",t),u=(u=u.replace("%product_title%",o)).replace("%customer_email%",t),(a=t)&&/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(a)){e(this).toggleClass("alert_loader").blur();let h={action:"alert_ajax",nonce:localizeData.nonce,email:t,product_id:i,variation_id:r};localizeData.additional_fields.forEach(s=>{h[s]=e("#woo_stock_manager_"+s).val()}),e.post(localizeData.ajax_url,h,function(s){"0"==s?e(".stock_notifier-subscribe-form").html(`<div class="registered_message"> ${l} <a href="${window.location}"> ${d} </a></div>`):"/*?%already_registered%?*/"==s?e(".stock_notifier-subscribe-form").html(`<div class="registered_message">${u}</div>${v}<input type="hidden" class="subscribed_email" value="${t}" /><input type="hidden" class="product_id" value="${i}" /><input type="hidden" class="variation_id" value="${r}" />`):"/*?%ban_email_address%?*/"==s?e(".responseData_error_message").remove()&&e(".stock_notifier-subscribe-form").append(e(`<p class="responseData_error_message ban_email_address">${p}</p>`)):"/*?%ban_email_domain%?*/"==s?e(".responseData_error_message").remove()&&e(".stock_notifier-subscribe-form").append(e(`<p class="responseData_error_message ban_email_address">${b}</p>`)):"/*?%double_opt_in%?*/"==s?e(".stock_notifier-subscribe-form").html(`<div class="registered_message"> ${f}</div>`):e(".stock_notifier-subscribe-form").html(`<div class="registered_message">${n}</div>`),e(".stock_manager_button").replaceWith(c)})}else e(".responseData_error_message").remove()&&e(".stock_notifier-subscribe-form").append(e(`<p style="color:#e2401c;" class="responseData_error_message">${m}</p>`)),e(".stock_manager_button").replaceWith(c)}e(document).on("click",".stock_manager_button",function t(i){i.preventDefault(),e(this).text(localizeData.processing),e(this).addClass("stk_disabled");let r=localizeData.recaptcha_enabled;if(r){let o=s.find("#recaptchav3_secretkey").val(),c=s.find("#recaptchav3_response").val(),n={action:"recaptcha_validate_ajax",nonce:localizeData.nonce,captcha_secret:o,captcha_response:c};e.post(localizeData.ajax_url,n,function(s){s?a():(alert("Oops, recaptcha not varified!"),e(this).removeClass("stk_disabled"))})}else a()}),e(document).on("click",".unsubscribe_button",function a(t){t.preventDefault(),e(this).text(localizeData.processing),e(this).addClass("stk_disabled");let i={action:"unsubscribe_button",nonce:localizeData.nonce,customer_email:s.find(".subscribed_email").val(),product_id:s.find(".product_id").val(),var_id:s.find(".variation_id").val()},r=localizeData.alert_unsubscribe_message;r=r.replace("%customer_email%",i.customer_email);let o=localizeData.error_occurs;e.post(localizeData.ajax_url,i,function(s){s?e(".stock_notifier-subscribe-form").html(`<div class="registered_message"> ${r}</div>`):e(".stock_notifier-subscribe-form").html(`<div class="registered_message"> ${o}<a href="${window.location}"> ${localizeData.try_again}</a></div>`),e(this).removeClass("stk_disabled")})}),e(document).on("change","input.variation_id",function s(){let a=Number(e(this).val()),t=Number(e(".stock_notifier-shortcode-subscribe-form").data("product-id"));if(e(".stock_notifier-shortcode-subscribe-form").length&&a){let i={action:"get_variation_box_ajax",nonce:localizeData.nonce,product_id:t,variation_id:a};e.post(localizeData.ajax_url,i,function(s){e(".stock_notifier-shortcode-subscribe-form").html(s)})}else e(".stock_notifier-shortcode-subscribe-form").html("")})});